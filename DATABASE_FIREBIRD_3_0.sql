
CREATE DOMAIN BOOL AS SMALLINT
  CHECK (VALUE IS NULL OR VALUE IN (0, 1));


CREATE TABLE USUARIOS (
	ID_USUARIO integer generated by default as identity primary key,
	NOME_FUNCIONARIO VARCHAR(80) NOT NULL,
	NOME_USUARIO VARCHAR(60) NOT NULL,
	SENHA VARCHAR(20) NOT NULL,
	ADMINISTRADOR BOOL,
	ULTIMA_ALTERACAO DATE,
	INCLUIR BOOL,
	ALTERAR BOOL,
	EXCLUIR BOOL
);

INSERT INTO USUARIOS (
	NOME_FUNCIONARIO,
	NOME_USUARIO,
	SENHA,
	ADMINISTRADOR,
	ULTIMA_ALTERACAO,
	INCLUIR, 
	ALTERAR, 
	EXCLUIR)
	VALUES (
		'Administrador',
		'ADMIN',
		'SENHA',
		1,
		CURRENT_DATE,
		0,
		1,
		0
		);


/*DOCUMENTOS*/
CREATE TABLE DOCUMENTOS (
	ID_DOCUMENTO integer generated by default as identity primary key,
	CODIGO INT NOT NULL,
	DESCRICAO VARCHAR(60) NOT NULL,
	UTILIZA_NUM_ANO BOOL
);

/*INTERESSADOS*/
CREATE TABLE INTERESSADOS (
	ID_INTERESSADO integer generated by default as identity primary key,
	CODIGO INT NOT NULL,
	DESCRICAO VARCHAR(80) NOT NULL
);

/*DESTINATARIOS (ID_DESTINATARIO, CODIGO, DESCRICAO 60, EMAIL 60, ID_USUARIO FK)*/
CREATE TABLE DESTINATARIOS (
	ID_DESTINATARIO integer generated by default as identity primary key,
	CODIGO INT NOT NULL,
	DESCRICAO VARCHAR(60) NOT NULL,
	EMAIL VARCHAR(60),
	ID_USUARIO INT NOT NULL
);

ALTER TABLE DESTINATARIOS 
ADD FOREIGN KEY(ID_USUARIO)
REFERENCES USUARIOS(ID_USUARIO);

/*REGISTROS*/

CREATE TABLE REGISTROS (
	ID_REGISTRO integer generated by default as identity primary key,
	ASSUNTO VARCHAR(100) NOT NULL,
	NUM_DOC VARCHAR(10) NOT NULL,
	ANO_DOC VARCHAR(10) NOT NULL,
	DATA_INCLUSAO DATE,
	PROCEDENCIA VARCHAR(60),
	ID_TIPO_DOC INT NOT NULL,
	ID_INTERESSADO INT NOT NULL,
	ID_USUARIO INT NOT NULL
);

ALTER TABLE REGISTROS 
ADD FOREIGN KEY(ID_INTERESSADO)
REFERENCES INTERESSADOS(ID_INTERESSADO);

ALTER TABLE REGISTROS 
ADD FOREIGN KEY(ID_TIPO_DOC)
REFERENCES DOCUMENTOS(ID_DOCUMENTO);

ALTER TABLE REGISTROS 
ADD FOREIGN KEY(ID_USUARIO)
REFERENCES USUARIOS(ID_USUARIO);


/*HISTORICO_REGISTROS*/

CREATE TABLE HISTORICO_REGISTROS (
	ID_HISTORICO integer generated by default as identity primary key,
	ID_REGISTRO INT NOT NULL,
	DATA_ENTRADA DATE,
	HORA_ENTRADA VARCHAR(8),
	ID_DESTINAT_ORIGEM INT NOT NULL,
	DATA_SAIDA DATE,
	HORA_SAIDA VARCHAR(8),
	ID_DESTINAT_DESTINO INT NOT NULL,
	OBSERVACAO VARCHAR(100),
	DATA_INCLUSAO DATE,
	HORA_INCLUSAO VARCHAR(8),
	ID_USUARIO INT NOT NULL
);

ALTER TABLE HISTORICO_REGISTROS 
ADD FOREIGN KEY(ID_REGISTRO)
REFERENCES REGISTROS(ID_REGISTRO);

ALTER TABLE HISTORICO_REGISTROS 
ADD FOREIGN KEY(ID_DESTINAT_ORIGEM)
REFERENCES DESTINATARIOS(ID_DESTINATARIO);

ALTER TABLE HISTORICO_REGISTROS 
ADD FOREIGN KEY(ID_DESTINAT_DESTINO)
REFERENCES DESTINATARIOS(ID_DESTINATARIO);

ALTER TABLE HISTORICO_REGISTROS 
ADD FOREIGN KEY(ID_USUARIO)
REFERENCES USUARIOS(ID_USUARIO);

 
 
 




